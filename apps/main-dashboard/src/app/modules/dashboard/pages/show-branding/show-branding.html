<div class="w-full min-h-screen md:p-6 rounded-2xl relative">
  @if (isLoading()) {
    <!-- Loading State -->
    <div class="max-w-7xl mx-auto">
      <div class="bg-linear-to-r py-20">
        <div class="mb-4">
          <app-loader />
        </div>
        <h3 class="text-lg font-medium text-white mb-2">{{ 'common.loading' | translate }}</h3>
        <p class="text-gray-400">{{ 'dashboard.showBranding.loading.checking' | translate }}</p>
      </div>
    </div>
  } @else if (showBrandingGuide() && existingBranding()) {
    <!-- Display PDF Branding Guide -->
    <app-branding-display [branding]="existingBranding()!" (generateRequested)="generateBranding()">
    </app-branding-display>
    <div class="fixed top-4 left-4 z-50">
      <button
        (click)="hideBrandingGuide()"
        class="glass-card px-4 py-2 text-white hover:bg-white/20 transition-all duration-300"
      >
        <i class="pi pi-arrow-left mr-2"></i>
        {{ 'dashboard.showBranding.buttons.backToOverview' | translate }}
      </button>
    </div>
  } @else if (hasError() && isRetryable()) {
    <!-- Error state with retry button -->
    <div class="max-w-4xl mx-auto text-center py-10">
      <div class="glass-card p-8">
        <div class="mb-6">
          <i class="pi pi-exclamation-triangle text-6xl text-red-400 mb-4"></i>
        </div>
        <h3 class="text-2xl font-bold text-white mb-4">{{ 'common.error' | translate }}</h3>
        <p class="text-gray-300 mb-8">{{ errorMessage() }}</p>
        <div class="flex gap-4 justify-center">
          <button class="inner-button" (click)="retryLoadBranding()">
            <i class="pi pi-refresh mr-2"></i>
            {{ 'common.retry' | translate }}
          </button>
          <button
            class="glass-card px-6 py-3 text-white hover:bg-white/20 transition-all duration-300 rounded-lg"
            (click)="goToProjects()"
          >
            <i class="pi pi-arrow-left mr-2"></i>
            {{ 'dashboard.showBranding.buttons.backToProjects' | translate }}
          </button>
        </div>
      </div>
    </div>
  } @else if (hasProjectData() || hasBrandingData()) {
    <!-- Main Branding Overview -->
    <div class="max-w-7xl mx-auto space-y-8">
      <!-- Header Section -->
      <div class="glass-card p-6">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h1 class="text-3xl font-bold text-white mb-2">
              {{ 'dashboard.showBranding.title' | translate }}
            </h1>
            <p class="text-gray-300">
              @if (currentProject()) {
                {{ currentProject()!.name }}
              }
            </p>
          </div>
          @if (hasBrandingGuide()) {
            <button (click)="viewBrandingGuide()" class="inner-button">
              <i class="pi pi-file-pdf mr-2"></i>
              {{ 'dashboard.showBranding.buttons.getCharter' | translate }}
            </button>
          }
        </div>
      </div>

      <!-- Branding Elements Grid -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Logo Section -->
        <div class="glass-card p-6">
          <div class="flex items-center justify-between mb-6">
            <div>
              <h3 class="text-xl font-semibold text-white">
                {{ 'dashboard.showBranding.sections.logos.title' | translate }}
              </h3>
              <p class="text-gray-400 text-sm">
                {{ 'dashboard.showBranding.sections.logos.subtitle' | translate }}
              </p>
            </div>
            @if (
              existingBranding() &&
              (existingBranding()!.logo!.svg || existingBranding()!.generatedLogos!.length > 0)
            ) {
              <button
                (click)="showDialog()"
                class="glass-card px-4 py-2 text-white hover:bg-white/20 transition-all duration-300 rounded-lg flex items-center gap-2"
                [title]="'dashboard.showBranding.tooltips.downloadZip' | translate"
              >
                <i class="pi pi-download text-sm"></i>
                <span class="text-sm">ZIP</span>
              </button>
            }
          </div>

          @if (
            existingBranding() &&
            (existingBranding()!.logo!.svg || existingBranding()!.generatedLogos!.length > 0)
          ) {
            <!-- Real Logo Data -->
            <div class="space-y-4">
              @if (existingBranding()!.logo!.svg) {
                <!-- Selected Logo -->
                <div class="glass-card p-4 text-center">
                  <div
                    class="w-24 h-24 mx-auto mb-3 bg-white rounded-lg flex items-center justify-center p-2"
                  >
                    <img [src]="existingBranding()!.logo.svg" class="w-full h-full" />
                  </div>
                  <p class="text-white font-medium">
                    {{
                      existingBranding()!.logo.name ||
                        ('dashboard.showBranding.sections.logos.main' | translate)
                    }}
                  </p>
                  <p class="text-gray-400 text-sm">
                    {{ 'dashboard.showBranding.sections.logos.selected' | translate }}
                  </p>
                </div>
              }

              <!-- Logo Variations -->
              @if (existingBranding()!.logo!.variations) {
                <div class="grid grid-cols-2 gap-3">
                  @if (existingBranding()!.logo!.variations!.withText!.lightBackground) {
                    <div class="glass-card p-3 text-center">
                      <div
                        class="w-16 h-16 mx-auto mb-2 bg-white rounded flex items-center justify-center p-1"
                      >
                        <img
                          [src]="existingBranding()!.logo!.variations!.withText!.lightBackground"
                          class="w-full h-full"
                        />
                      </div>
                      <p class="text-white text-xs">
                        {{ 'dashboard.showBranding.sections.logos.lightBg' | translate }}
                      </p>
                    </div>
                  }
                  @if (existingBranding()!.logo.variations!.withText!.darkBackground) {
                    <div class="glass-card p-3 text-center">
                      <div
                        class="w-16 h-16 mx-auto mb-2 bg-gray-800/50 rounded flex items-center justify-center p-1"
                      >
                        <img
                          [src]="existingBranding()!.logo.variations!.withText!.darkBackground"
                          class="w-full h-full"
                        />
                      </div>
                      <p class="text-white text-xs">
                        {{ 'dashboard.showBranding.sections.logos.darkBg' | translate }}
                      </p>
                    </div>
                  }
                  @if (existingBranding()!.logo.variations!.iconOnly!.lightBackground!) {
                    <div class="glass-card p-3 text-center">
                      <div
                        class="w-16 h-16 mx-auto mb-2 bg-white rounded flex items-center justify-center p-1"
                      >
                        <img
                          [src]="existingBranding()!.logo.variations!.iconOnly!.lightBackground"
                          class="w-full h-full"
                        />
                      </div>
                      <p class="text-white text-xs">
                        {{ 'dashboard.showBranding.sections.logos.iconOnly' | translate }}
                      </p>
                    </div>
                  }
                  @if (existingBranding()!.logo.variations!.withText?.monochrome) {
                    <div class="glass-card p-3 text-center">
                      <div
                        class="w-16 h-16 mx-auto mb-2 bg-white/10 rounded flex items-center justify-center p-1"
                      >
                        <img
                          [src]="existingBranding()!.logo.variations!.withText!.monochrome"
                          class="w-full h-full"
                        />
                      </div>
                      <p class="text-white text-xs">
                        {{ 'dashboard.showBranding.sections.logos.monochrome' | translate }}
                      </p>
                    </div>
                  }
                </div>
              }
            </div>
          } @else {
            <div class="bg-linear-to-r py-8">
              <i class="pi pi-image text-4xl text-gray-500 mb-3"></i>
              <p class="text-gray-400">{{ 'dashboard.showBranding.empty.noLogos' | translate }}</p>
            </div>
          }
        </div>

        <!-- Colors Section -->
        <div class="glass-card p-6">
          <div class="flex items-center mb-6">
            <div>
              <h3 class="text-xl font-semibold text-white">
                {{ 'dashboard.showBranding.sections.colors.title' | translate }}
              </h3>
              <p class="text-gray-400 text-sm">
                {{ 'dashboard.showBranding.sections.colors.subtitle' | translate }}
              </p>
            </div>
          </div>

          @if (
            existingBranding() &&
            (existingBranding()!.colors!.colors || existingBranding()!.generatedColors!.length > 0)
          ) {
            <!-- Real Color Data -->
            <div class="space-y-4">
              @if (existingBranding()!.colors!.colors) {
                <!-- Selected Color Palette -->
                <div class="space-y-3">
                  <p class="text-white font-medium mb-3">
                    {{
                      existingBranding()!.colors.name ||
                        ('dashboard.showBranding.sections.colors.selected' | translate)
                    }}
                  </p>
                  <div class="grid grid-cols-2 gap-3">
                    @if (existingBranding()!.colors.colors.primary) {
                      <div class="glass-card p-3">
                        <div
                          class="w-full h-12 rounded mb-2"
                          [style.background-color]="existingBranding()!.colors.colors.primary"
                        ></div>
                        <p class="text-white text-sm font-medium">
                          {{ 'dashboard.showBranding.sections.colors.primary' | translate }}
                        </p>
                        <p class="text-gray-400 text-xs">
                          {{ existingBranding()!.colors.colors.primary }}
                        </p>
                      </div>
                    }
                    @if (existingBranding()!.colors.colors.secondary) {
                      <div class="glass-card p-3">
                        <div
                          class="w-full h-12 rounded mb-2"
                          [style.background-color]="existingBranding()!.colors.colors.secondary"
                        ></div>
                        <p class="text-white text-sm font-medium">
                          {{ 'dashboard.showBranding.sections.colors.secondary' | translate }}
                        </p>
                        <p class="text-gray-400 text-xs">
                          {{ existingBranding()!.colors.colors.secondary }}
                        </p>
                      </div>
                    }
                    @if (existingBranding()!.colors.colors.accent) {
                      <div class="glass-card p-3">
                        <div
                          class="w-full h-12 rounded mb-2"
                          [style.background-color]="existingBranding()!.colors.colors.accent"
                        ></div>
                        <p class="text-white text-sm font-medium">
                          {{ 'dashboard.showBranding.sections.colors.accent' | translate }}
                        </p>
                        <p class="text-gray-400 text-xs">
                          {{ existingBranding()!.colors.colors.accent }}
                        </p>
                      </div>
                    }
                    @if (existingBranding()!.colors.colors.background) {
                      <div class="glass-card p-3">
                        <div
                          class="w-full h-12 rounded mb-2"
                          [style.background-color]="existingBranding()!.colors.colors.background"
                        ></div>
                        <p class="text-white text-sm font-medium">
                          {{ 'dashboard.showBranding.sections.colors.background' | translate }}
                        </p>
                        <p class="text-gray-400 text-xs">
                          {{ existingBranding()!.colors.colors.background }}
                        </p>
                      </div>
                    }
                  </div>
                </div>
              }
            </div>
          } @else {
            <div class="bg-linear-to-r py-8">
              <i class="pi pi-palette text-4xl text-gray-500 mb-3"></i>
              <p class="text-gray-400">{{ 'dashboard.showBranding.empty.noColors' | translate }}</p>
            </div>
          }
        </div>

        <!-- Typography Section -->
        <div class="glass-card p-6">
          <div class="flex items-center mb-6">
            <div>
              <h3 class="text-xl font-semibold text-white">
                {{ 'dashboard.showBranding.sections.typography.title' | translate }}
              </h3>
              <p class="text-gray-400 text-sm">
                {{ 'dashboard.showBranding.sections.typography.subtitle' | translate }}
              </p>
            </div>
          </div>

          @if (
            existingBranding() &&
            (existingBranding()!.typography!.primaryFont ||
              existingBranding()!.generatedTypography!.length > 0)
          ) {
            <!-- Real Typography Data -->
            <div class="space-y-4">
              @if (existingBranding()!.typography!.primaryFont) {
                <!-- Selected Typography -->
                <div class="space-y-3">
                  <p class="text-white font-medium mb-3">
                    {{
                      existingBranding()!.typography.name ||
                        ('dashboard.showBranding.sections.typography.selected' | translate)
                    }}
                  </p>

                  <!-- Primary Font -->
                  <div class="glass-card p-4">
                    <h4
                      class="text-2xl font-bold text-white mb-2"
                      [style.font-family]="existingBranding()!.typography.primaryFont"
                    >
                      {{ existingBranding()!.typography.primaryFont }}
                    </h4>
                    <p class="text-gray-400 text-sm mb-3">
                      {{ 'dashboard.showBranding.sections.typography.primary' | translate }}
                    </p>
                    <div class="space-y-1">
                      <p
                        class="text-white text-lg font-bold"
                        [style.font-family]="existingBranding()!.typography.primaryFont"
                      >
                        Aa Bb Cc
                      </p>
                      <p
                        class="text-gray-300 text-base font-medium"
                        [style.font-family]="existingBranding()!.typography.primaryFont"
                      >
                        Aa Bb Cc
                      </p>
                      <p
                        class="text-gray-400 text-sm"
                        [style.font-family]="existingBranding()!.typography.primaryFont"
                      >
                        Aa Bb Cc
                      </p>
                    </div>
                  </div>

                  <!-- Secondary Font -->
                  @if (existingBranding()!.typography.secondaryFont) {
                    <div class="glass-card p-4">
                      <h4
                        class="text-xl text-white mb-2"
                        [style.font-family]="existingBranding()!.typography.secondaryFont"
                      >
                        {{ existingBranding()!.typography.secondaryFont }}
                      </h4>
                      <p class="text-gray-400 text-sm mb-3">
                        {{ 'dashboard.showBranding.sections.typography.secondary' | translate }}
                      </p>
                      <div class="space-y-1">
                        <p
                          class="text-white text-base"
                          [style.font-family]="existingBranding()!.typography.secondaryFont"
                        >
                          Aa Bb Cc
                        </p>
                        <p
                          class="text-gray-300 text-sm"
                          [style.font-family]="existingBranding()!.typography.secondaryFont"
                        >
                          Aa Bb Cc
                        </p>
                      </div>
                    </div>
                  }
                </div>
              }
            </div>
          } @else {
            <div class="bg-linear-to-r py-8">
              <i class="pi pi-font text-4xl text-gray-500 mb-3"></i>
              <p class="text-gray-400">
                {{ 'dashboard.showBranding.empty.noTypography' | translate }}
              </p>
            </div>
          }
        </div>
      </div>
    </div>
  } @else {
    <!-- Empty State - No project ID -->
    <div class="max-w-4xl mx-auto text-center py-20">
      <div class="glass-card p-8">
        <div class="mb-6">
          <i class="pi pi-exclamation-triangle text-6xl text-gray-400 mb-4"></i>
        </div>
        <h3 class="text-2xl font-bold text-white mb-4">
          {{ 'dashboard.showBranding.empty.noProject.title' | translate }}
        </h3>
        <p class="text-gray-300 mb-8">
          {{ 'dashboard.showBranding.empty.noProject.subtitle' | translate }}
        </p>
        <button class="inner-button" (click)="goToProjects()">
          <i class="pi pi-folder mr-2"></i>
          {{ 'dashboard.showBranding.buttons.selectProject' | translate }}
        </button>
      </div>
    </div>
  }

  <!-- Extension Selection Dialog -->
  <p-dialog
    [header]="'dashboard.showBranding.dialog.title' | translate"
    [modal]="true"
    [(visible)]="visible"
    [style]="{ width: '25rem' }"
    styleClass="extension-dialog centered-modal"
  >
    <span class="p-text-secondary block mb-8">{{
      'dashboard.showBranding.dialog.subtitle' | translate
    }}</span>

    <!-- Extension Options -->
    <div class="space-y-3 mb-6">
      <!-- SVG Option -->
      <div
        class="glass-card p-4 cursor-pointer transition-all duration-300 hover:bg-white/10"
        [class.ring-2]="selectedExtension === 'svg'"
        [class.ring-blue-400]="selectedExtension === 'svg'"
        (click)="selectExtension('svg')"
      >
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-3">
            <div class="w-12 h-12 bg-zinc-200 rounded-lg flex items-center justify-center p-2">
              <img
                src="https://uxwing.com/wp-content/themes/uxwing/download/file-and-folder-type/svg-icon.png"
                alt="SVG"
                class="w-full h-full"
              />
            </div>
            <div>
              <h4 class="text-white font-medium">
                {{ 'dashboard.showBranding.dialog.formats.svg.name' | translate }}
              </h4>
              <p class="text-gray-400 text-sm">
                {{ 'dashboard.showBranding.dialog.formats.svg.description' | translate }}
              </p>
            </div>
          </div>
          @if (selectedExtension === 'svg') {
            <i class="pi pi-check-circle text-blue-400"></i>
          }
        </div>
      </div>

      <!-- PNG Option -->
      <div
        class="glass-card p-4 cursor-pointer transition-all duration-300 hover:bg-white/10"
        [class.ring-2]="selectedExtension === 'png'"
        [class.ring-green-400]="selectedExtension === 'png'"
        (click)="selectExtension('png')"
      >
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-3">
            <div class="w-12 h-12 bg-zinc-200 rounded-lg flex items-center justify-center p-2">
              <img
                src="https://cdn-icons-png.flaticon.com/512/337/337948.png"
                alt="PNG"
                class="w-full h-full"
              />
            </div>
            <div>
              <h4 class="text-white font-medium">
                {{ 'dashboard.showBranding.dialog.formats.png.name' | translate }}
              </h4>
              <p class="text-gray-400 text-sm">
                {{ 'dashboard.showBranding.dialog.formats.png.description' | translate }}
              </p>
            </div>
          </div>
          @if (selectedExtension === 'png') {
            <i class="pi pi-check-circle text-green-400"></i>
          }
        </div>
      </div>

      <!-- PSD Option -->
      <div
        class="glass-card p-4 cursor-pointer transition-all duration-300 hover:bg-white/10"
        [class.ring-2]="selectedExtension === 'psd'"
        [class.ring-purple-400]="selectedExtension === 'psd'"
        (click)="selectExtension('psd')"
      >
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-3">
            <div class="w-12 h-12 bg-zinc-200 rounded-lg flex items-center justify-center p-2">
              <img
                src="https://cdn-icons-png.flaticon.com/512/9645/9645799.png"
                alt="PSD"
                class="w-full h-full"
              />
            </div>
            <div>
              <h4 class="text-white font-medium">
                {{ 'dashboard.showBranding.dialog.formats.psd.name' | translate }}
              </h4>
              <p class="text-gray-400 text-sm">
                {{ 'dashboard.showBranding.dialog.formats.psd.description' | translate }}
              </p>
            </div>
          </div>
          @if (selectedExtension === 'psd') {
            <i class="pi pi-check-circle text-purple-400"></i>
          }
        </div>
      </div>
    </div>

    <div class="flex justify-end gap-2">
      <button class="outer-button" (click)="visible = false" [disabled]="isDownloading()">
        {{ 'common.cancel' | translate }}
      </button>
      <button class="inner-button" (click)="downloadLogosZip()" [disabled]="isDownloading()">
        {{ (isDownloading() ? 'common.downloading' : 'common.download') | translate }}
      </button>
    </div>

    <!-- Loading overlay -->
    @if (isDownloading()) {
      <div
        class="absolute inset-0 bg-black/50 backdrop-blur-sm rounded-lg flex items-center justify-center"
      >
        <div class="bg-linear-to-r">
          <app-loader />
          <p class="text-white mt-4 font-medium">
            {{ 'dashboard.showBranding.dialog.preparing' | translate }}
          </p>
          <p class="text-gray-400 text-sm">
            {{ 'dashboard.showBranding.dialog.wait' | translate }}
          </p>
        </div>
      </div>
    }
  </p-dialog>
</div>
