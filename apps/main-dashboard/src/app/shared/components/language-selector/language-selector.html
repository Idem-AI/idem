<div class="relative w-full">
  <!-- Language Button -->
  <button
    (click)="toggleDropdown()"
    class="flex items-center gap-2 px-3 py-2 rounded-lg glass-card hover:bg-white/10 transition-all duration-200 border border-white/10"
    [attr.aria-label]="'common.changeLanguage' | translate"
  >
    <span class="text-lg">{{ getCurrentLanguageObject()?.flag }}</span>
    <span class="hidden sm:inline text-white text-sm font-medium">{{
      getCurrentLanguageObject()?.name
    }}</span>
    <svg
      class="w-4 h-4 text-gray-400 transition-transform duration-200"
      [class.rotate-180]="isOpen()"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
    </svg>
  </button>

  <!-- Dropdown Menu -->
  @if (isOpen()) {
    <div
      class="absolute right-0 bottom-full mb-2 w-48 glass-card border border-white/10 rounded-lg shadow-xl z-50 py-2 animate-fade-in"
    >
      @for (language of languages; track language.code) {
        <button
          (click)="changeLanguage(language.code)"
          class="w-full flex items-center gap-3 px-4 py-3 text-white hover:bg-white/5 transition-all duration-200"
          [ngClass]="{
            'bg-primary/10 border-l-2 border-primary': currentLanguage() === language.code,
          }"
        >
          <span class="text-xl">{{ language.flag }}</span>
          <span class="text-sm font-medium">{{ language.name }}</span>
          @if (currentLanguage() === language.code) {
            <svg class="w-4 h-4 ml-auto text-primary" fill="currentColor" viewBox="0 0 20 20">
              <path
                fill-rule="evenodd"
                d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                clip-rule="evenodd"
              />
            </svg>
          }
        </button>
      }
    </div>
  }
</div>
